# 코딩애플 리액트

## 왜 리액트가 필요한가?
- 새로고침 없이 앱처럼 웹 탐색이 가능한 요즘 `SNS`를 살펴보자. 실제로 앱은 아니지만, 모바일 앱이랑 사용성이 동일해서 `Web-app`이라고 불린다.
- `Web-app`을 쉽게 만들 수 있는 라이브러리/프레임워크 3가지 중에서 `React`에 대해서 배워보도록 한다.
  - React
  - Angular
  - Vue

## 리액트 설치, 개발환경 세팅
- [node.js](https://nodejs.org/en/) 설치 (LTS 설치 권장)
- [VSCode](https://code.visualstudio.com/) 설치

터미널에서 프로젝트를 진행할 디렉토리로 이동 후 다음 명령어 입력
```
$ npx create-react-app 프로젝트명 // create-react-app 라이브러리로 프로젝트 생성
$ sudo npx create-react-app 프로젝트명 // 위 명령어 오류 sudo를 붙인다.
```
<br>
CRA 설치를 완료했으면 VSCode로 해당 폴더를 열고 command+j로 터미널을 열고 다음 명령어를 입력한다.

```
npm start // 프로젝트 미리보기
```
<br>
React 둘러보기

- **node_modules** - 라이브러리 코드 보관
- **public** - static 파일 보관
- **src** - 소스코드 보관

## JSX 문법
1. 클래스 이름을 부여할 때는 `className`을 이용한다.
2. 데이터바인딩은 `{}` 중괄호를 이용한다.
3. HTML에 인라인 스타일 넣고 싶다면 `style={}`내에 `{}`자료형으로 넣어야 한다.
4. `return()` 내에 태그를 병렬로 2개 이상 기입이 허용되지 않는다.
  ```
  <div style={{color: 'blue', fontSize: '30px'}}>코딩애플</div>
  ```


## State
- React에서는 자료를 보관하기 위해서 변수 말고 `state`를 사용하기도 한다.
```
import { useState } from 'react';

let [a, b] = useState('이웃집 토토로') // Destructuring, a에는 이웃집 토토로 값이 담긴다.
```
- **`state`를 사용하는 이유?** 변수는 변경되면 `HTML`에 반영되지 않지만, `state`는 값이 변경되면 `HTML`이 자동으로 재렌더링 된다.
- 자주 변경되는 `HTML` 부분은 `state`로 만들어 놓는다.

## State 변경하기
- `useState()`를 변수에 담을 때, `let [a, b]`와 같은 형태에 담았다. 이 때, b의 역할은 a의 값을 변경할 때 사용하는 **state 변경함수**이다.
- 위에서 설명했듯이 변수를 사용하면 `HTML`에 담긴 값은 **재렌더링** 되지 않는다. `a=a+1`과 같은 수식으로 웹 페이지에서 값이 바뀐 결과를 기대하지 말아야 한다.
```
// 좋아요버튼 누르면 숫자가 증가하도록 하시오.
function App() {

  let [postTitle] = useState(['이웃집 토토로', '모모노케 히메', '바람계곡의 나우시카']);
  let [likeBtn, setLikeBtn] = useState(0);

  <div className="App">
    <div className="list">
      <h4>
        {postTitle[0]}
        <span onClick={() => {setLikeBtn(likeBtn+1)}} 👍 </span> {likeBtn}
      </h4>
    </div>
  </div>
}
```
- `setLikeBtn`으로 `likeBtn`값을 증가시켜 재렌더링할 수 있었다.
```
<button onClick={() => {
        let copyPostTitle = [...postTitle];
        copyPostTitle[0] = '마녀 배달부 키키';
        setPostTitle(copyPostTitle)}}>글수정</button>
```
- 버튼을 눌렀을 때 첫번째 값이 '마녀 배달부 키키'로 변경 시키고 싶다면 위와 같은 코드를 입력한다.
- `array`, `object` 자료를 다룰 때는 원본 데이터를 직접 조작하는 것보다 기존 값을 보존해주는 식으로 코딩하는게 좋다(*copy*).
- `object`의 동작 원리를 이해하여 똑같은 값을 참조하는 `let copyPostTitle = postTitle`과 같은 코드는 나오지 않도록 한다. `state`는 변경함수에 들어 있는 값이 기존 `state`와 비교해서 값이 같다면, 자원 절약을 위해서 변경하지 않는다.
```
<button onClick={() => {
        let copyPostTitle = [...postTitle];
        setPostTitle(copyPostTitle.sort());
        }}>가나다 정렬</button>
```
- 위와 같은 원리로 글제목을 가나다 순서로 정렬할 수 있다.

## Component
- `HTML`은 작성하다보면 가독성이 떨어진다. React에서는 가독성을 위해서 `HTML`을 축약할 수 있는 `Component`문법이 있다. 컴포넌트를 만들기 위해서는 아래의 과정을 거친다.
1. `function()` 생성 - 첫 글자는 대문자
2. `return()`내에 HTML 담기
3. `<함수명 />` 사용
```
function Modal() {
  return(
    <div className="modal">
      <h4>Title</h4>
      <p>Date</p>
      <p>Content</p>
    </div>
  );
}

// 다른 함수 내에서 아래와 같이 사용
<Modal />
```
- 다른 코드에 복잡하게 `HTML`을 작성할 필요 없이 다른 곳에 작성한 후 `<Modal />`하나만 넣으면 된다.  
#### Component는 언제 사용하면 좋은가?
- 반복적인 `HTML`을 축약할 때 사용하면 된다.
- 큰 페이지들
- 자주 변경되는 `UI`

## 동적인 UI 만드는 3단계
1. `HTML` CSS로 미리 디자인 완성해놓기.
2. `UI`의 현재 상태를 `state`로 저장해놓기.
3. `state`에 따라서 `UI`가 어떻게 보일지 작성한다.
#### 동적인 모달창 만들기
```
let [modal, setModal] = useState(false);

<div className="list">
  <h4 onClick={() => {
    setModal(!modal);
  }}>{postTitle[2]}</h4>
</div>

{
  modal===true ? <Modal /> : null
}
```
- React에서는 조건문, 반복문을 사용할 수 없다.
- `삼항 연산자`를 통해서 조건문을 구현할 수 있다.

## 많은 `<div>`를 반복문으로 줄이고 싶을 때
- `map` 메서드를 사용한다.
- array 자료의 갯수만큼 함수 내의 코드를 반복한다.
```
[a, b, c].map(a, i) {
  console.log(a); // 배열의 값이 담긴다 => a, b, c
  console.log(i); // 반복문이 돌 때마다 0부터 1씩 증가하는 수 => 0, 1, 2
  return 'new'; // return에 값을 적으면 array에 담는다 => ['new', 'new', 'new']
}
```
```
{
  postTitle.map((title, i) => {
    return(
      <div className="list" key={i}>
        <h4 onClick={() => {
            setModal(!modal);
          }}>{ title }
          <span onClick={() => {
            let copyLikeBtn = [...likeBtn];
            copyLikeBtn[i] = copyLikeBtn[i]+1;
            setLikeBtn(copyLikeBtn)}}> 👍 </span> {likeBtn[i]}
        </h4>
        <p>2월 17일 발행</p>
      </div>
    );
  })
  }
```
- 반복해서 생성되는 게시글을 `map`을 이용해서 만들었다.

## props
- 함수 내에서 사용된 변수는 외부에서 사용할 수 없다.
- 부모 컴포넌트에서 자식 컴포넌트에게 `state`를 전송할 수 있다.
- `props` 문법을 사용하면 부모 `state`를 사용할 수 있다.
```
// 부모가 자식에게 state 전송하는 법
<Component 보낼이름={state이름}/>

// 자식
function Modal(props) {
  return(
    <div className="modal">
      <h4>{props.보낼이름}</h4>
    </div>
  );
}
```
#### 모달창에 해당 제목 가져오기
```
let [titleNum, setTitleNum] = useState(0) // 현재 정보를 담는 state 선언
postTitle.map((title, i) { // 여기에 다음 내용만 추가
  <h4 onClick={() => {
      setTitleNum(i); // titleNum 값을 0~2로 가져올 수 있다.
  }}>
})
{ modal === true ? <Modal titleNum={titleNum}/> : null } // Modal 컴포넌트에 해당 값을 보낸다.
function Modal(props) {
  return(
    <h4>{ props.postTitle[props.titleNum] }</h4> // 이제 해당제목 가져올 수 있다.
  );
}
```

## 사용자가 입력한 글 다루기
```
on????{(e) => {
    e.stopPropagation(); // 상위 html로 퍼지는 이벤트 버블링을 막을 수 있다.
    e.target.value(); // 이벤트가 발생한 태그의 값을 가져올 수 있다.
}}
```

**버튼 클릭시 글 발행, 삭제 기능 추가한 전체 코드**
<img src="https://user-images.githubusercontent.com/96946274/168487742-8584519b-5d6c-42e9-839a-e9e93ca61865.png">
```
import './App.css';
import {useState} from 'react';

function App() {

  let [postTitle, setPostTitle] = useState(['이웃집 토토로', '모노노케 히메', '바람계곡의 나우시카']);
  let [likeBtn, setLikeBtn] = useState([0, 0, 0]);
  let [modal, setModal] = useState(false);
  let [titleNum, setTitleNum] = useState(0);
  let [userInput, setUserInput] = useState('');

  return (
    <div className="App">
      <div className="black-nav">
        <h4>GHIBLI</h4>
      </div>

      <button onClick={() => {
        let copyPostTitle = [...postTitle];
        copyPostTitle[0] = '마녀 배달부 키키';
        setPostTitle(copyPostTitle)}}>글수정</button>

      <button onClick={() => {
        let copyPostTitle = [...postTitle];
        setPostTitle(copyPostTitle.sort());
      }}>가나다 정렬</button>

      {
        postTitle.map((title, i) => {
          return(
            <div className="list" key={i}>
              <h4 onClick={() => {
                  setModal(!modal);
                  setTitleNum(i);
                }}>{ title }
                <span onClick={(e) => {
                  e.stopPropagation();
                  let copyLikeBtn = [...likeBtn];
                  copyLikeBtn[i] = copyLikeBtn[i]+1;
                  setLikeBtn(copyLikeBtn)}}> 👍 </span> {likeBtn[i]}
              </h4>
              <p>2월 17일 발행</p>
              <button onClick={() => {
                let copyPostTitle = [...postTitle];
                copyPostTitle.splice(i, 1);
                setPostTitle(copyPostTitle);
              }}>삭제</button>
            </div>
          );
        })
      }

      <input onChange={(e) => {
        setUserInput(e.target.value);
      }}></input>
      <button onClick={() => {
        let copyPostTitle = [...postTitle];
        copyPostTitle.unshift(userInput);
        setPostTitle(copyPostTitle);
      }}>글발행</button>

      {
        modal===true ? <Modal postTitle={postTitle} setPostTitle={setPostTitle} titleNum={titleNum}/> : null
      }

    </div>
  );
}

function Modal(props) {
  return (
    <div className="modal">
      <h4>{ props.postTitle[props.titleNum] }</h4>
      <p>날짜</p>
      <p>상세내용</p>
    </div>
  );
}

export default App;

```
